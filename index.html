<!DOCTYPE html>
<html>
<head>
    <title>Real-time Dashboard</title>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    #laps_left_in_race {
        font-size: 18em;
        font-weight: bolder;
        /*font-family: Aeros,monospace;*/
    }

    .titles {
        font-size: 6em;
    }

    body {
        font-family: Arial,serif;
        background-color: #222;
        color: #ddd;
    }

    a {
        color: #6cf;
    }

    a:hover {
        color: #9cf;
    }
    body {
        text-align: center;
    }

    .row {
        display: flex;
        align-items: center;
    }

    .column {
        width: 33.33%;
        padding: 10px;
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        justify-content: center;
        text-align: center;
    }

</style>
<body>
<div class="row">
    <div class="column titles">
noch
    </div>
    <div class="column" id="laps_left_in_race"></div>
    <div class="column titles">
Runden
    </div>
</div>

<b>Nachzutankender Sprit zum Abschluss des Rennens</b>
<div id="fuel_div"></div>

<b>Sprit n√∂tig um Rennen zu beenden</b>
<div id="fuel_needed_to_finish_race"></div>

<b>Speed</b>
<div id="speed"></div>
<b>Sprit verbleibend</b>
<div id="fuel_left"></div>

<b>Package Id</b>
<div id="package_id"></div>

<b>Spritverbrauch letzte Rd.</b>
<div id="fuel_consumption_last_lap"></div>

<b>Spritverbrauch Durchschnitt</b>
<div id="fuel_consumption_avg"></div>

<b>Renndauer</b>
<div id="race_time_in_minutes"></div>

<b>Dauer Rennen</b>
<div id="time_since_start"></div>

<p><a href="/?min=60">60 min</a></p>
<p><a href="/?min=25">25 min</a></p>
<p><a href="/?min=10">10 min</a></p>

<script>
    const dashboard = document.getElementById('dashboard');
    const socket = new WebSocket('ws://localhost:9100/ws');

    socket.addEventListener('message', (event) => {
        const data = JSON.parse(event.data);

        fuel_left.textContent = data.fuel_left + '%';
        speed.textContent = data.speed + ' km/h';
        package_id.textContent = data.package_id;
        fuel_consumption_avg.textContent = data.fuel_consumption_avg

        if (data.valid_state) {
            fuel_div.textContent = data.fuel_div + '%';

            fuel_consumption_last_lap.textContent = data.fuel_consumption_last_lap
            time_since_start.textContent = data.time_since_start;
            race_time_in_minutes.textContent = data.race_time_in_minutes + " min";
            fuel_needed_to_finish_race.textContent = data.fuel_needed_to_finish_race + " %";
            laps_left_in_race.textContent = data.laps_left_in_race;
        } else {
            fuel_div.textContent = "-";
            fuel_consumption_last_lap.textContent = "-";
            time_since_start.textContent = "-";
            race_time_in_minutes.textContent = "-";
            fuel_needed_to_finish_race.textContent = "-";
        }

    });
</script>
</body>
</html>
